[PHP]
; Disable dangerous functions (allow passthru for shell execution)
disable_functions = exec,shell_exec,popen,system,file_get_contents,readfile,file,fopen,fread,fgets,show_source,print_r,var_dump,strlen

; Restrict PHP to web root and allow accessing root files via glob
open_basedir = /var/www/html:/tmp:/readflag:/

; Security settings
expose_php = Off
display_errors = Off
log_errors = On
error_reporting = E_ALL

; Session settings
session.use_strict_mode = 1
session.cookie_httponly = 1

; Disable potentially dangerous features
allow_url_include = Off
allow_url_fopen = Off

; Enable FFI for FPM (needed for the exploit chain)
; Note: ffi.enable in php.ini is often restricted to php_admin_value in FPM conf
; So we also handle it via docker-php-fpm.conf overrides below
ffi.enable = 1

; Auto-load filter.php before each request
auto_prepend_file = /var/www/html/filter.php
