worker_processes 1;
events { 
    worker_connections 1024; 
}

http {
    include mime.types;
    default_type application/octet-stream;
    sendfile on;
    keepalive_timeout 65;

    port_in_redirect off;

    server {
        listen 80;
        root /usr/share/nginx/html;
        index index.html;

        # 处理 /admin
        location = /admin {
            # $http_host 会自动携带用户访问时的“IP:端口”，避免丢端口
            return 301 http://$http_host/admin/;
        }

        # 处理 /admin/ 带斜杠，加 try_files 防止内部跳转丢路径
        location /admin/ {
            auth_basic "Admin Area";
            auth_basic_user_file /etc/nginx/.htpasswd;
            index index.html;
            # 确保访问 /admin/ 下的资源时，路径正确不跳转
            try_files $uri $uri/ /admin/index.html;
        }

        # 你的原静态资源缓存配置
        location ~* \.(css|js|jpg|png|ico|svg)$ {
            expires 1d;
            add_header Cache-Control "public, max-age=86400";
        }

        # 你的原根路径配置
        location / {
            try_files $uri $uri/ /index.html;
        }
    }
}
